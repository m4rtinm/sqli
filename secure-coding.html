<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laboratorio de C√≥digo Seguro: Prevenci√≥n de SQLi</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.10.3/sql-wasm.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .toast { opacity: 0; transition: opacity 0.3s ease-in-out; }
        .toast.show { opacity: 1; }
        .challenge-card.locked { opacity: 0.6; pointer-events: none; }
        .challenge-card { transition: all 0.3s ease; }
        .vulnerability-indicator {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .vuln-safe { background: #059669; color: white; }
        .vuln-vulnerable { background: #dc2626; color: white; }
        .vuln-partial { background: #d97706; color: white; }
        .sql-red { color: #ef4444; }
        .sql-blue { color: #3b82f6; }
        .sql-green { color: #10b981; }
        .sql-gray { color: #6b7280; }
        .sql-table { color: #f59e0b; }
        .font-fira { font-family: 'Courier New', monospace; }
        .code-editor {
            background: #1f2937;
            border: 1px solid #374151;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        .code-editor:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
        }
        .vulnerability-example {
            background: linear-gradient(45deg, #fee2e2, #fef2f2);
            border-left: 4px solid #dc2626;
        }
        .vulnerability-example pre code {
            color: #1f2937 !important;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px;
            border-radius: 4px;
            display: block;
        }
        .secure-example {
            background: linear-gradient(45deg, #d1fae5, #f0fdf4);
            border-left: 4px solid #059669;
        }
        .secure-example pre code {
            color: #1f2937 !important;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px;
            border-radius: 4px;
            display: block;
        }
        .code-preview {
            background: #0f172a;
            border: 1px solid #334155;
            border-radius: 8px;
            color: #e2e8f0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.4;
        }
        .code-highlight-vuln {
            background-color: rgba(239, 68, 68, 0.2);
            border-left: 3px solid #ef4444;
            padding-left: 8px;
        }
        .code-highlight-safe {
            background-color: rgba(16, 185, 129, 0.2);
            border-left: 3px solid #10b981;
            padding-left: 8px;
        }
        .step-indicator {
            display: inline-block;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #3b82f6;
            color: white;
            text-align: center;
            line-height: 24px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 8px;
        }
        .step-indicator.completed {
            background: #10b981;
        }
        .step-indicator.current {
            background: #f59e0b;
            animation: pulse 2s infinite;
        }
        .nav-link {
            padding: 8px 16px;
            border-radius: 6px;
            transition: all 0.2s;
            text-decoration: none;
        }
        .nav-link:hover {
            background-color: #f3f4f6;
            color: #1f2937;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200">

    <!-- Navegaci√≥n -->
    <nav class="bg-white dark:bg-gray-800 shadow-lg mb-8">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-8">
                    <h1 class="text-xl font-bold text-blue-600 dark:text-blue-400">üõ°Ô∏è Laboratorio de C√≥digo Seguro</h1>
                    <div class="hidden md:flex space-x-4">
                        <a href="index.html" class="nav-link text-gray-600 dark:text-gray-300">üéØ Laboratorio de Hacking</a>
                        <a href="secure-coding.html" class="nav-link bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200">üõ°Ô∏è C√≥digo Seguro</a>
                    </div>
                </div>
                <div class="text-sm text-gray-600 dark:text-gray-400">
                    Aprende a defenderte contra SQLi
                </div>
            </div>
        </div>
    </nav>

    <!-- Notificaci√≥n Toast -->
    <div id="toast" class="toast fixed bottom-5 right-5 bg-green-500 text-white py-3 px-6 rounded-lg shadow-xl z-50">
        <p id="toast-message">¬°Desaf√≠o completado!</p>
    </div>

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-green-600 dark:text-green-400">Laboratorio de C√≥digo Seguro: Prevenci√≥n de SQLi</h1>
            <p class="mt-2 text-lg text-gray-600 dark:text-gray-400">Aprende a escribir c√≥digo seguro y protegerte contra inyecciones SQL.</p>
        </header>

        <!-- Barra de progreso -->
        <div class="w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700 mb-8">
            <div id="progress-bar" class="bg-green-600 h-2.5 rounded-full relative overflow-hidden" style="width: 0%; transition: width 0.5s ease-in-out;">
                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 animate-pulse"></div>
            </div>
        </div>
        <div class="text-center mb-4">
            <span id="progress-text" class="text-sm text-gray-600 dark:text-gray-400">0% completado - ¬°Comienza a asegurar tu c√≥digo!</span>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <!-- Panel Izquierdo: Desaf√≠os de C√≥digo Seguro -->
            <div class="space-y-6">
                <h2 class="text-2xl font-bold">üõ°Ô∏è Desaf√≠os de C√≥digo Seguro</h2>
                
                <!-- Desaf√≠o 1: Statements Preparados -->
                <div id="challenge-1" class="challenge-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-green-500">
                    <div class="flex justify-between items-start">
                        <h3 class="text-xl font-bold flex-1 mr-2">Nivel 1: Implementa Prepared Statements</h3>
                        <div class="flex flex-col gap-2 sm:flex-row">
                            <span class="text-xs font-medium px-2.5 py-0.5 rounded bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300">‚≠ê B√°sico</span>
                            <span class="text-xs font-medium px-2.5 py-0.5 rounded bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300">Prepared Statements</span>
                        </div>
                    </div>
                    <div class="challenge-content">
                        <p class="mt-2 text-gray-600 dark:text-gray-400">Tienes un login vulnerable. Tu misi√≥n: reescribir el c√≥digo usando <strong>prepared statements</strong> para prevenir inyecciones SQL.</p>
                        
                        <!-- Pasos educativos -->
                        <div class="mt-4 mb-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border-l-4 border-blue-500">
                            <h4 class="font-bold text-blue-800 dark:text-blue-200 mb-2">üìö Pasos para completar este desaf√≠o:</h4>
                            <div class="space-y-2 text-sm">
                                <div id="step-1-1" class="flex items-center">
                                    <span class="step-indicator" id="indicator-1-1">1</span>
                                    <span>Reemplaza la concatenaci√≥n de strings con placeholders (?)</span>
                                </div>
                                <div id="step-1-2" class="flex items-center">
                                    <span class="step-indicator" id="indicator-1-2">2</span>
                                    <span>Pasa los par√°metros como array separado [username, password]</span>
                                </div>
                                <div id="step-1-3" class="flex items-center">
                                    <span class="step-indicator" id="indicator-1-3">3</span>
                                    <span>Usa m√©todos como db.prepare() o db.query() con par√°metros</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- C√≥digo vulnerable -->
                        <div class="mt-4 vulnerability-example p-4 rounded-lg">
                            <h4 class="font-bold text-red-800 mb-2">‚ùå C√≥digo Vulnerable:</h4>
                            <pre class="text-sm font-mono overflow-x-auto"><code>function authenticateUser(username, password) {
    // ‚ö†Ô∏è PELIGRO: Concatenaci√≥n directa permite inyecci√≥n
    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;
    return db.query(query);
}</code></pre>
                            <div class="mt-2 p-2 bg-red-100 dark:bg-red-900/30 rounded text-xs">
                                <strong>¬øPor qu√© es vulnerable?</strong> Si un atacante ingresa <code>'admin' --</code> como usuario, la consulta se convierte en: 
                                <code class="block mt-1 font-mono">SELECT * FROM users WHERE username = 'admin' -- ' AND password = '...'</code>
                                El <code>--</code> comenta el resto, ignorando la validaci√≥n de contrase√±a.
                            </div>
                        </div>

                        <!-- Editor de c√≥digo seguro -->
                        <div class="mt-4">
                            <h4 class="font-bold text-green-800 mb-2">‚úÖ Tu c√≥digo seguro:</h4>
                            <textarea id="input-1-code" class="code-editor w-full h-32 p-3 text-gray-100" placeholder="function authenticateUser(username, password) {
    // Paso 1: Usa placeholders en lugar de concatenaci√≥n
    const query = 'SELECT * FROM users WHERE username = ? AND password = ?';
    // Paso 2: Pasa par√°metros por separado
    return db.prepare(query).all(username, password);
}">function authenticateUser(username, password) {
    // Escribe aqu√≠ tu implementaci√≥n segura usando prepared statements
    
}</textarea>
                        </div>

                        <!-- Render en tiempo real -->
                        <div class="mt-4">
                            <h4 class="font-bold text-blue-800 mb-2">üîç Vista previa de tu c√≥digo:</h4>
                            <div class="code-preview p-4">
                                <pre id="code-preview-1" class="text-sm m-0 whitespace-pre-wrap">// Escribe c√≥digo arriba para ver el an√°lisis en tiempo real...</pre>
                            </div>
                        </div>

                        <button id="btn-1" class="mt-4 w-full bg-green-600 text-white font-bold py-2 px-4 rounded-md hover:bg-green-700">Validar C√≥digo Seguro</button>
                        
                        <div class="mt-2 text-right"><button onclick="toggleHint(1)" class="text-sm text-green-500 hover:underline">Necesito una pista</button></div>
                        <p id="hint-1" class="hidden mt-2 p-2 bg-green-50 dark:bg-green-900/20 text-sm rounded">
                            Los <strong>prepared statements</strong> separan la l√≥gica SQL de los datos. Usa placeholders como <code class="font-fira bg-green-200 dark:bg-green-800 px-1 rounded">?</code> o <code class="font-fira bg-green-200 dark:bg-green-800 px-1 rounded">$1, $2</code> y pasa los par√°metros por separado.
                        </p>
                        <div id="result-1" class="mt-4 p-3 rounded-md text-sm min-h-[50px]"></div>
                    </div>
                </div>

                <!-- Desaf√≠o 2: Validaci√≥n de Entrada -->
                <div id="challenge-2" class="challenge-card locked bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-gray-500">
                    <div class="flex justify-between items-start">
                        <h3 class="text-xl font-bold flex-1 mr-2">Nivel 2: Validaci√≥n y Sanitizaci√≥n</h3>
                        <div class="flex flex-col gap-2 sm:flex-row">
                            <span class="text-xs font-medium px-2.5 py-0.5 rounded bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300">‚≠ê‚≠ê Intermedio</span>
                            <span class="text-xs font-medium px-2.5 py-0.5 rounded bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300">Input Validation</span>
                        </div>
                    </div>
                    <div class="challenge-content">
                        <p class="mt-2 text-gray-600 dark:text-gray-400">Implementa validaci√≥n robusta para un buscador de productos. Valida tipos de datos, longitudes y caracteres permitidos.</p>
                        
                        <!-- Pasos educativos -->
                        <div class="mt-4 mb-4 p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border-l-4 border-yellow-500">
                            <h4 class="font-bold text-yellow-800 dark:text-yellow-200 mb-2">üìö Pasos para completar este desaf√≠o:</h4>
                            <div class="space-y-2 text-sm">
                                <div id="step-2-1" class="flex items-center">
                                    <span class="step-indicator" id="indicator-2-1">1</span>
                                    <span>Validar que la entrada sea de tipo string</span>
                                </div>
                                <div id="step-2-2" class="flex items-center">
                                    <span class="step-indicator" id="indicator-2-2">2</span>
                                    <span>Verificar longitud m√°xima (ej: 100 caracteres)</span>
                                </div>
                                <div id="step-2-3" class="flex items-center">
                                    <span class="step-indicator" id="indicator-2-3">3</span>
                                    <span>Rechazar caracteres peligrosos: ' " ; -- \</span>
                                </div>
                                <div id="step-2-4" class="flex items-center">
                                    <span class="step-indicator" id="indicator-2-4">4</span>
                                    <span>Usar prepared statements para la consulta final</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4 vulnerability-example p-4 rounded-lg">
                            <h4 class="font-bold text-red-800 mb-2">‚ùå C√≥digo Vulnerable:</h4>
                            <pre class="text-sm font-mono overflow-x-auto"><code>function searchProducts(searchTerm) {
    // ‚ö†Ô∏è Sin validaci√≥n - acepta cualquier entrada
    const query = `SELECT * FROM products WHERE name LIKE '%${searchTerm}%'`;
    return db.query(query);
}</code></pre>
                            <div class="mt-2 p-2 bg-red-100 dark:bg-red-900/30 rounded text-xs">
                                <strong>¬øPor qu√© es vulnerable?</strong> Si un atacante ingresa <code>' UNION SELECT username,password FROM users --</code>, 
                                la consulta se convierte en un ataque UNION que expone datos de usuarios.
                            </div>
                        </div>

                        <div class="mt-4">
                            <h4 class="font-bold text-green-800 mb-2">‚úÖ Tu c√≥digo seguro:</h4>
                            <textarea id="input-2-code" class="code-editor w-full h-40 p-3 text-gray-100" placeholder="function searchProducts(searchTerm) {
    // Paso 1: Validar tipo
    if (typeof searchTerm !== 'string') {
        throw new Error('Tipo de entrada inv√°lido');
    }
    
    // Paso 2: Validar longitud
    if (searchTerm.length > 100) {
        throw new Error('Entrada demasiado larga');
    }
    
    // Paso 3: Validar caracteres
    if (/['\";\\--]/.test(searchTerm)) {
        throw new Error('Caracteres no permitidos');
    }
    
    // Paso 4: Usar prepared statement
    const query = 'SELECT * FROM products WHERE name LIKE ?';
    return db.prepare(query).all(`%${searchTerm}%`);
}">function searchProducts(searchTerm) {
    // Implementa validaci√≥n y sanitizaci√≥n aqu√≠
    
}</textarea>
                        </div>

                        <!-- Render en tiempo real -->
                        <div class="mt-4">
                            <h4 class="font-bold text-blue-800 mb-2">üîç Vista previa de tu c√≥digo:</h4>
                            <div class="code-preview p-4">
                                <pre id="code-preview-2" class="text-sm m-0 whitespace-pre-wrap">// Escribe c√≥digo arriba para ver el an√°lisis en tiempo real...</pre>
                            </div>
                        </div>

                        <button id="btn-2" class="mt-4 w-full bg-green-600 text-white font-bold py-2 px-4 rounded-md hover:bg-green-700">Validar C√≥digo Seguro</button>
                        
                        <div class="mt-2 text-right"><button onclick="toggleHint(2)" class="text-sm text-green-500 hover:underline">Necesito una pista</button></div>
                        <p id="hint-2" class="hidden mt-2 p-2 bg-green-50 dark:bg-green-900/20 text-sm rounded">
                            Valida: <strong>tipo de dato</strong> (string), <strong>longitud m√°xima</strong>, <strong>caracteres permitidos</strong> (evita <code>'</code>, <code>;</code>, <code>--</code>), y usa <strong>prepared statements</strong> junto con la validaci√≥n.
                        </p>
                        <div id="result-2" class="mt-4 p-3 rounded-md text-sm min-h-[50px]"></div>
                    </div>
                </div>

                <!-- Desaf√≠o 3: Escape de Caracteres -->
                <div id="challenge-3" class="challenge-card locked bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-gray-500">
                    <div class="flex justify-between items-start">
                        <h3 class="text-xl font-bold flex-1 mr-2">Nivel 3: Escapado Seguro</h3>
                        <div class="flex flex-col gap-2 sm:flex-row">
                            <span class="text-xs font-medium px-2.5 py-0.5 rounded bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300">‚≠ê‚≠ê‚≠ê Avanzado</span>
                            <span class="text-xs font-medium px-2.5 py-0.5 rounded bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300">Character Escaping</span>
                        </div>
                    </div>
                    <div class="challenge-content">
                        <p class="mt-2 text-gray-600 dark:text-gray-400">En ocasiones necesitas concatenar SQL din√°mico. Implementa una funci√≥n de escape segura para neutralizar caracteres peligrosos.</p>
                        
                        <div class="mt-4 vulnerability-example p-4 rounded-lg">
                            <h4 class="font-bold text-red-800 mb-2">‚ùå C√≥digo Vulnerable:</h4>
                            <pre class="text-sm font-mono overflow-x-auto"><code>function buildDynamicQuery(orderBy, direction) {
    // Concatenaci√≥n directa sin validaci√≥n
    return `SELECT * FROM products ORDER BY ${orderBy} ${direction}`;
}</code></pre>
                        </div>

                        <div class="mt-4">
                            <h4 class="font-bold text-green-800 mb-2">‚úÖ Tu c√≥digo seguro:</h4>
                            <textarea id="input-3-code" class="code-editor w-full h-40 p-3 text-gray-100" placeholder="function buildDynamicQuery(orderBy, direction) {
    // Implementa escapado y validaci√≥n segura aqu√≠
    
}">function buildDynamicQuery(orderBy, direction) {
    // Implementa escapado y validaci√≥n segura aqu√≠
    
}</textarea>
                        </div>

                        <button id="btn-3" class="mt-4 w-full bg-green-600 text-white font-bold py-2 px-4 rounded-md hover:bg-green-700">Validar C√≥digo Seguro</button>
                        
                        <div class="mt-2 text-right"><button onclick="toggleHint(3)" class="text-sm text-green-500 hover:underline">Necesito una pista</button></div>
                        <p id="hint-3" class="hidden mt-2 p-2 bg-green-50 dark:bg-green-900/20 text-sm rounded">
                            Usa <strong>whitelisting</strong> para <code>orderBy</code> (solo columnas v√°lidas) y <code>direction</code> (solo 'ASC'/'DESC'). Si necesitas escapar strings, dobla las comillas simples: <code>'</code> ‚Üí <code>''</code>.
                        </p>
                        <div id="result-3" class="mt-4 p-3 rounded-md text-sm min-h-[50px]"></div>
                    </div>
                </div>

                <!-- Desaf√≠o 4: ORM y Abstracci√≥n -->
                <div id="challenge-4" class="challenge-card locked bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-gray-500">
                    <div class="flex justify-between items-start">
                        <h3 class="text-xl font-bold flex-1 mr-2">Nivel 4: Uso de ORM Seguro</h3>
                        <div class="flex flex-col gap-2 sm:flex-row">
                            <span class="text-xs font-medium px-2.5 py-0.5 rounded bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300">‚≠ê‚≠ê‚≠ê‚≠ê Experto</span>
                            <span class="text-xs font-medium px-2.5 py-0.5 rounded bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300">ORM Security</span>
                        </div>
                    </div>
                    <div class="challenge-content">
                        <p class="mt-2 text-gray-600 dark:text-gray-400">Los ORMs pueden ser vulnerables si se usan incorrectamente. Implementa consultas seguras usando m√©todos seguros del ORM.</p>
                        
                        <div class="mt-4 vulnerability-example p-4 rounded-lg">
                            <h4 class="font-bold text-red-800 mb-2">‚ùå C√≥digo Vulnerable (ORM inseguro):</h4>
                            <pre class="text-sm font-mono overflow-x-auto"><code>// Usando raw query en ORM - ¬°PELIGROSO!
function getUserData(userId) {
    return ORM.query(`SELECT * FROM users WHERE id = ${userId} AND active = 1`);
}</code></pre>
                        </div>

                        <div class="mt-4">
                            <h4 class="font-bold text-green-800 mb-2">‚úÖ Tu c√≥digo seguro con ORM:</h4>
                            <textarea id="input-4-code" class="code-editor w-full h-40 p-3 text-gray-100" placeholder="function getUserData(userId) {
    // Usa m√©todos seguros del ORM aqu√≠
    
}">function getUserData(userId) {
    // Usa m√©todos seguros del ORM aqu√≠
    
}</textarea>
                        </div>

                        <button id="btn-4" class="mt-4 w-full bg-green-600 text-white font-bold py-2 px-4 rounded-md hover:bg-green-700">Validar C√≥digo Seguro</button>
                        
                        <div class="mt-2 text-right"><button onclick="toggleHint(4)" class="text-sm text-green-500 hover:underline">Necesito una pista</button></div>
                        <p id="hint-4" class="hidden mt-2 p-2 bg-green-50 dark:bg-green-900/20 text-sm rounded">
                            Evita <code>ORM.query()</code> con strings concatenados. Usa m√©todos como <code>ORM.where()</code>, <code>ORM.find()</code>, <code>ORM.findById()</code> que autom√°ticamente parametrizan las consultas.
                        </p>
                        <div id="result-4" class="mt-4 p-3 rounded-md text-sm min-h-[50px]"></div>
                    </div>
                </div>

                <!-- Desaf√≠o 5: Auditor√≠a de C√≥digo -->
                <div id="challenge-5" class="challenge-card locked bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-gray-500">
                    <div class="flex justify-between items-start">
                        <h3 class="text-xl font-bold flex-1 mr-2">Nivel 5: Auditor√≠a y Detecci√≥n</h3>
                        <div class="flex flex-col gap-2 sm:flex-row">
                            <span class="text-xs font-medium px-2.5 py-0.5 rounded bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Maestro</span>
                            <span class="text-xs font-medium px-2.5 py-0.5 rounded bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300">Code Audit</span>
                        </div>
                    </div>
                    <div class="challenge-content">
                        <p class="mt-2 text-gray-600 dark:text-gray-400">Identifica todas las vulnerabilidades en este c√≥digo complejo y prop√≥n las correcciones adecuadas.</p>
                        
                        <div class="mt-4 vulnerability-example p-4 rounded-lg">
                            <h4 class="font-bold text-red-800 mb-2">‚ùå C√≥digo para auditar:</h4>
                            <pre class="text-sm font-mono overflow-x-auto"><code>function complexQuery(userInput, sortBy, category) {
    let query = "SELECT p.*, u.username FROM products p JOIN users u ON p.user_id = u.id";
    
    if (category) {
        query += ` WHERE p.category = '${category}'`;
    }
    
    if (userInput) {
        query += category ? " AND" : " WHERE";
        query += ` p.name LIKE '%${userInput}%'`;
    }
    
    query += ` ORDER BY p.${sortBy} ASC`;
    
    return db.query(query);
}</code></pre>
                        </div>

                        <div class="mt-4">
                            <h4 class="font-bold text-green-800 mb-2">‚úÖ Tu c√≥digo corregido:</h4>
                            <textarea id="input-5-code" class="code-editor w-full h-48 p-3 text-gray-100" placeholder="function complexQuery(userInput, sortBy, category) {
    // Corrige todas las vulnerabilidades aqu√≠
    
}">function complexQuery(userInput, sortBy, category) {
    // Corrige todas las vulnerabilidades aqu√≠
    
}</textarea>
                        </div>

                        <button id="btn-5" class="mt-4 w-full bg-green-600 text-white font-bold py-2 px-4 rounded-md hover:bg-green-700">Validar Auditor√≠a</button>
                        
                        <div class="mt-2 text-right"><button onclick="toggleHint(5)" class="text-sm text-green-500 hover:underline">Necesito una pista</button></div>
                        <p id="hint-5" class="hidden mt-2 p-2 bg-green-50 dark:bg-green-900/20 text-sm rounded">
                            Encuentra: <strong>3 puntos de inyecci√≥n</strong> (category, userInput, sortBy). Usa prepared statements, validaci√≥n de entrada y whitelisting para columnas.
                        </p>
                        <div id="result-5" class="mt-4 p-3 rounded-md text-sm min-h-[50px]"></div>
                    </div>
                </div>

            </div>

            <!-- Panel Derecho: An√°lisis de Seguridad -->
            <div class="bg-gray-900 rounded-xl shadow-2xl p-6 flex flex-col sticky top-8 h-max">
                <h2 class="text-2xl font-bold text-gray-200">üîç An√°lisis de Seguridad</h2>
                
                <!-- Estado de seguridad en tiempo real -->
                <div class="mt-4">
                    <h3 class="font-semibold text-gray-300 mb-2">Estado de Seguridad del C√≥digo</h3>
                    <div class="bg-black rounded-lg p-4 font-fira text-sm overflow-x-auto border border-gray-700" id="security-container">
                        <pre id="security-status" class="text-gray-300 m-0 whitespace-pre-wrap leading-relaxed">// Esperando c√≥digo para analizar...</pre>
                    </div>
                    
                    <!-- Indicador de vulnerabilidad -->
                    <div class="mt-2 flex items-center justify-between">
                        <span id="vulnerability-status" class="vulnerability-indicator vuln-safe">C√ìDIGO SEGURO</span>
                        <span id="security-score" class="text-xs text-gray-400">Puntuaci√≥n: -/-</span>
                    </div>
                </div>

                <!-- Vulnerabilidades detectadas -->
                <div id="vulnerabilities-box" class="mt-4">
                    <h3 class="font-semibold text-gray-300 mb-2">üö® Vulnerabilidades Detectadas</h3>
                    <div id="vulnerabilities-content" class="p-3 bg-gray-800 rounded-lg text-sm text-gray-300 min-h-[80px] overflow-y-auto" style="max-height: 200px;">
                        üí° Escribe c√≥digo para ver el an√°lisis de vulnerabilidades.
                    </div>
                </div>

                <!-- Recomendaciones de seguridad -->
                <div id="recommendations-box" class="mt-4">
                    <h3 class="font-semibold text-gray-300 mb-2">‚úÖ Recomendaciones</h3>
                    <div id="recommendations-content" class="p-3 bg-gray-800 rounded-lg text-sm text-gray-300 min-h-[60px]">
                        // Las recomendaciones aparecer√°n aqu√≠
                    </div>
                </div>

                <!-- Gu√≠a de mejores pr√°cticas -->
                <div id="best-practices" class="mt-4">
                    <h3 class="font-semibold text-gray-300 mb-2">üìö Mejores Pr√°cticas</h3>
                    <div class="p-3 bg-gray-800 rounded-lg text-sm text-gray-300">
                        <ul class="space-y-1 text-xs">
                            <li>‚Ä¢ Usa <span class="text-green-400">prepared statements</span> siempre</li>
                            <li>‚Ä¢ Valida y sanitiza <span class="text-blue-400">todas las entradas</span></li>
                            <li>‚Ä¢ Implementa <span class="text-yellow-400">whitelisting</span> para par√°metros din√°micos</li>
                            <li>‚Ä¢ Usa <span class="text-purple-400">principio de menor privilegio</span></li>
                            <li>‚Ä¢ Activa <span class="text-red-400">logging y monitoreo</span></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recursos adicionales -->
        <div class="mt-12 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
            <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 mb-6">üìñ Recursos de Aprendizaje</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border-l-4 border-blue-500">
                    <h3 class="font-bold text-blue-800 dark:text-blue-200 mb-2">üîó OWASP SQL Injection</h3>
                    <p class="text-sm text-gray-600 dark:text-gray-400">Gu√≠a completa de OWASP sobre prevenci√≥n de inyecciones SQL.</p>
                    <a href="#" class="text-blue-600 text-sm hover:underline">Ver gu√≠a ‚Üí</a>
                </div>
                
                <div class="p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border-l-4 border-green-500">
                    <h3 class="font-bold text-green-800 dark:text-green-200 mb-2">üìã Checklist de Seguridad</h3>
                    <p class="text-sm text-gray-600 dark:text-gray-400">Lista de verificaci√≥n para c√≥digo seguro contra SQLi.</p>
                    <a href="#" class="text-green-600 text-sm hover:underline">Descargar ‚Üí</a>
                </div>
                
                <div class="p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border-l-4 border-purple-500">
                    <h3 class="font-bold text-purple-800 dark:text-purple-200 mb-2">üõ†Ô∏è Herramientas de Testing</h3>
                    <p class="text-sm text-gray-600 dark:text-gray-400">Herramientas para probar tu c√≥digo contra SQLi.</p>
                    <a href="#" class="text-purple-600 text-sm hover:underline">Ver herramientas ‚Üí</a>
                </div>
            </div>
        </div>
    </div>

    <script>
    // --- ESTADO DEL JUEGO Y CONFIGURACI√ìN ---
    const state = {
        unlockedLevels: [1],
        completedLevels: [],
        currentChallenge: 1
    };

    // Desaf√≠os de c√≥digo seguro
    const secureChallenges = {
        1: {
            name: "Prepared Statements",
            solution: [
                "const query = 'SELECT * FROM users WHERE username = ? AND password = ?';",
                "return db.prepare(query).all(username, password);",
                "// o db.query(query, [username, password]);"
            ],
            vulnerabilities: ["string concatenation", "sql injection"],
            check: (code) => {
                const hasPlaceholders = /\?|\$\d+/.test(code);
                const hasParameterArray = /\[.*username.*password.*\]|\(.*username.*password.*\)|\.all\(.*username.*password.*\)/.test(code);
                const noConcatenation = !(/\$\{|\+.*username|\+.*password|`.*\$\{/.test(code));
                const hasPrepareOrQuery = /\.prepare\(|\.query\(/.test(code);
                
                return {
                    secure: hasPlaceholders && hasParameterArray && noConcatenation && hasPrepareOrQuery,
                    score: (hasPlaceholders ? 30 : 0) + (hasParameterArray ? 30 : 0) + (noConcatenation ? 25 : 0) + (hasPrepareOrQuery ? 15 : 0),
                    issues: [
                        !hasPlaceholders ? "Falta usar placeholders (? o $1, $2)" : null,
                        !hasParameterArray ? "Falta pasar par√°metros por separado" : null,
                        !noConcatenation ? "A√∫n hay concatenaci√≥n de strings peligrosa" : null,
                        !hasPrepareOrQuery ? "Falta usar m√©todos db.prepare() o db.query()" : null
                    ].filter(Boolean)
                };
            }
        },
        2: {
            name: "Input Validation",
            solution: [
                "if (typeof searchTerm !== 'string') throw new Error('Invalid input type');",
                "if (searchTerm.length > 100) throw new Error('Input too long');",
                "if (/['\"\\\\;--]/.test(searchTerm)) throw new Error('Invalid characters');",
                "const query = 'SELECT * FROM products WHERE name LIKE ?';",
                "return db.prepare(query).all(`%${searchTerm}%`);"
            ],
            check: (code) => {
                const hasTypeCheck = /typeof.*string|instanceof.*String/.test(code);
                const hasLengthCheck = /length.*>|length.*<|length.*===/.test(code);
                const hasCharacterCheck = /['\"\\\\;--].*test|test.*['\"\\\\;--]|match.*['\"\\\\;--]/.test(code);
                const hasPlaceholders = /\?|\$\d+/.test(code);
                const hasErrorHandling = /throw|return.*error|Error\(/i.test(code);
                
                return {
                    secure: hasTypeCheck && hasLengthCheck && hasCharacterCheck && hasPlaceholders && hasErrorHandling,
                    score: (hasTypeCheck ? 20 : 0) + (hasLengthCheck ? 20 : 0) + (hasCharacterCheck ? 25 : 0) + (hasPlaceholders ? 20 : 0) + (hasErrorHandling ? 15 : 0),
                    issues: [
                        !hasTypeCheck ? "Falta validaci√≥n de tipo de dato (typeof)" : null,
                        !hasLengthCheck ? "Falta validaci√≥n de longitud m√°xima" : null,
                        !hasCharacterCheck ? "Falta validaci√≥n de caracteres peligrosos" : null,
                        !hasPlaceholders ? "Falta usar prepared statements" : null,
                        !hasErrorHandling ? "Falta manejo de errores (throw Error)" : null
                    ].filter(Boolean)
                };
            }
        },
        3: {
            name: "Character Escaping",
            solution: [
                "const allowedColumns = ['name', 'price', 'category', 'date'];",
                "const allowedDirections = ['ASC', 'DESC'];",
                "if (!allowedColumns.includes(orderBy)) throw new Error('Invalid column');",
                "if (!allowedDirections.includes(direction.toUpperCase())) throw new Error('Invalid direction');",
                "return `SELECT * FROM products ORDER BY ${orderBy} ${direction.toUpperCase()}`;"
            ],
            check: (code) => {
                const hasWhitelist = /allowedColumns|whitelist.*column|includes.*orderBy/.test(code);
                const hasDirectionCheck = /allowedDirections|ASC.*DESC/.test(code);
                const noDirectConcatenation = !/ORDER BY.*\$\{.*\}.*\$\{/.test(code) || hasWhitelist;
                
                return {
                    secure: hasWhitelist && hasDirectionCheck && noDirectConcatenation,
                    score: (hasWhitelist ? 50 : 0) + (hasDirectionCheck ? 30 : 0) + (noDirectConcatenation ? 20 : 0),
                    issues: [
                        !hasWhitelist ? "Falta whitelist para columnas permitidas" : null,
                        !hasDirectionCheck ? "Falta validaci√≥n de direcci√≥n (ASC/DESC)" : null,
                        !noDirectConcatenation ? "Concatenaci√≥n directa sin validaci√≥n" : null
                    ].filter(Boolean)
                };
            }
        },
        4: {
            name: "ORM Security",
            solution: [
                "// Validar entrada",
                "const id = parseInt(userId);",
                "if (isNaN(id) || id <= 0) throw new Error('Invalid user ID');",
                "// Usar m√©todos seguros del ORM",
                "return ORM.User.findOne({ where: { id: id, active: 1 } });"
            ],
            check: (code) => {
                const avoidsRawQuery = !/ORM\.query.*\$\{|ORM\.query.*\+/.test(code);
                const usesORMMethods = /findOne|find|where|findById/.test(code);
                const hasValidation = /parseInt|isNaN|typeof/.test(code);
                
                return {
                    secure: avoidsRawQuery && usesORMMethods && hasValidation,
                    score: (avoidsRawQuery ? 40 : 0) + (usesORMMethods ? 40 : 0) + (hasValidation ? 20 : 0),
                    issues: [
                        !avoidsRawQuery ? "A√∫n usa ORM.query() con concatenaci√≥n" : null,
                        !usesORMMethods ? "No usa m√©todos seguros del ORM (findOne, where, etc.)" : null,
                        !hasValidation ? "Falta validaci√≥n de entrada" : null
                    ].filter(Boolean)
                };
            }
        },
        5: {
            name: "Code Audit",
            solution: [
                "function complexQuery(userInput, sortBy, category) {",
                "    // Validaci√≥n de entradas",
                "    const allowedColumns = ['name', 'price', 'category', 'date_created'];",
                "    if (!allowedColumns.includes(sortBy)) throw new Error('Invalid sort column');",
                "    // Prepared statement",
                "    const params = [];",
                "    let query = 'SELECT p.*, u.username FROM products p JOIN users u ON p.user_id = u.id WHERE 1=1';",
                "    if (category) { query += ' AND p.category = ?'; params.push(category); }",
                "    if (userInput) { query += ' AND p.name LIKE ?'; params.push(`%${userInput}%`); }",
                "    query += ` ORDER BY p.${sortBy} ASC`;",
                "    return db.prepare(query).all(params);",
                "}"
            ],
            check: (code) => {
                const hasColumnWhitelist = /allowedColumns|includes.*sortBy/.test(code);
                const usesPreparedStatements = /\?.*params|prepare.*all/.test(code);
                const noConcatenation = !/\$\{category\}|\+.*category|\$\{userInput\}|\+.*userInput/.test(code);
                const hasParameterArray = /params.*push|params.*\[/.test(code);
                
                return {
                    secure: hasColumnWhitelist && usesPreparedStatements && noConcatenation && hasParameterArray,
                    score: (hasColumnWhitelist ? 25 : 0) + (usesPreparedStatements ? 35 : 0) + (noConcatenation ? 25 : 0) + (hasParameterArray ? 15 : 0),
                    issues: [
                        !hasColumnWhitelist ? "Falta whitelist para columna sortBy" : null,
                        !usesPreparedStatements ? "No usa prepared statements" : null,
                        !noConcatenation ? "A√∫n hay concatenaci√≥n directa de par√°metros" : null,
                        !hasParameterArray ? "Falta manejo correcto de par√°metros" : null
                    ].filter(Boolean)
                };
            }
        }
    };

    // Inicializaci√≥n
    document.addEventListener('DOMContentLoaded', () => {
        setupChallengeHandlers();
        updateProgress();
    });

    function setupChallengeHandlers() {
        for (let i = 1; i <= 5; i++) {
            const btn = document.getElementById(`btn-${i}`);
            const textarea = document.getElementById(`input-${i}-code`);
            
            if (btn && textarea) {
                btn.addEventListener('click', () => handleSecureCodeSubmit(i));
                textarea.addEventListener('input', () => {
                    handleRealtimeSecurityAnalysis(i);
                    updateCodePreview(i);
                    updateStepProgress(i);
                });
                
                // Trigger initial analysis
                handleRealtimeSecurityAnalysis(i);
                updateCodePreview(i);
            }
        }
    }

    function updateCodePreview(id) {
        const textarea = document.getElementById(`input-${id}-code`);
        const preview = document.getElementById(`code-preview-${id}`);
        
        if (!textarea || !preview) return;
        
        const code = textarea.value.trim();
        if (!code) {
            preview.textContent = '// Escribe c√≥digo arriba para ver el an√°lisis en tiempo real...';
            return;
        }

        const challenge = secureChallenges[id];
        const analysis = challenge.check(code);
        
        // Crear preview con highlighting
        let previewText = `// An√°lisis en tiempo real de tu c√≥digo:\n\n${code}\n\n`;
        previewText += `// üìä Estado: ${analysis.secure ? '‚úÖ SEGURO' : '‚ùå VULNERABLE'}\n`;
        previewText += `// üèÜ Puntuaci√≥n: ${analysis.score}/100\n`;
        
        if (analysis.issues.length > 0) {
            previewText += `\n// ‚ö†Ô∏è Problemas detectados:\n`;
            analysis.issues.forEach(issue => {
                previewText += `// ‚Ä¢ ${issue}\n`;
            });
        } else {
            previewText += `\n// ‚úÖ ¬°Excelente! No se detectaron problemas\n`;
        }

        preview.textContent = previewText;
        
        // Aplicar colores basados en seguridad
        preview.className = analysis.secure ? 
            'text-sm m-0 whitespace-pre-wrap code-highlight-safe' : 
            'text-sm m-0 whitespace-pre-wrap code-highlight-vuln';
    }

    function updateStepProgress(id) {
        const textarea = document.getElementById(`input-${id}-code`);
        if (!textarea) return;
        
        const code = textarea.value.trim();
        const challenge = secureChallenges[id];
        const analysis = challenge.check(code);
        
        // Actualizar indicadores de pasos seg√∫n el desaf√≠o
        if (id === 1) {
            updateStep(1, 1, /\?|\$\d+/.test(code));
            updateStep(1, 2, /\[.*username.*password.*\]|\(.*username.*password.*\)/.test(code));
            updateStep(1, 3, /prepare|query.*\[/.test(code));
        } else if (id === 2) {
            updateStep(2, 1, /typeof.*string/.test(code));
            updateStep(2, 2, /length.*>|length.*</.test(code));
            updateStep(2, 3, /['\"\\\\;--]/.test(code) && /test|match/.test(code));
            updateStep(2, 4, /\?|\$\d+/.test(code) && /prepare|query.*\[/.test(code));
        }
    }

    function updateStep(challengeId, stepNum, completed) {
        const indicator = document.getElementById(`indicator-${challengeId}-${stepNum}`);
        if (!indicator) return;
        
        indicator.className = 'step-indicator';
        if (completed) {
            indicator.className += ' completed';
        }
    }

    function handleSecureCodeSubmit(id) {
        const textarea = document.getElementById(`input-${id}-code`);
        const result = document.getElementById(`result-${id}`);
        const code = textarea.value.trim();
        
        if (!code) {
            showResult(result, 'Por favor, escribe algo de c√≥digo.', 'error');
            return;
        }

        const challenge = secureChallenges[id];
        const analysis = challenge.check(code);
        
        if (analysis.secure) {
            showResult(result, `‚úÖ ¬°Excelente! Tu c√≥digo es seguro. Puntuaci√≥n: ${analysis.score}/100`, 'success');
            completeChallenge(id);
        } else {
            const issues = analysis.issues.join('<br>‚Ä¢ ');
            showResult(result, `‚ùå C√≥digo inseguro. Puntuaci√≥n: ${analysis.score}/100<br><br>Problemas encontrados:<br>‚Ä¢ ${issues}`, 'error');
        }
        
        updateSecurityAnalysis(code, analysis, challenge.vulnerabilities);
    }

    function handleRealtimeSecurityAnalysis(id) {
        const textarea = document.getElementById(`input-${id}-code`);
        if (!textarea) return;
        
        const code = textarea.value.trim();
        
        if (!code) {
            updateSecurityStatus('// Esperando c√≥digo para analizar...', 'ESPERANDO', 0);
            return;
        }

        const challenge = secureChallenges[id];
        if (!challenge) return;
        
        const analysis = challenge.check(code);
        updateSecurityAnalysis(code, analysis, challenge.vulnerabilities);
    }

    function updateSecurityAnalysis(code, analysis, knownVulns) {
        // Actualizar estado de seguridad
        const status = analysis.secure ? 'C√ìDIGO SEGURO' : 'VULNERABILIDADES DETECTADAS';
        const statusClass = analysis.secure ? 'vuln-safe' : 'vuln-vulnerable';
        
        const vulnStatusEl = document.getElementById('vulnerability-status');
        const scoreEl = document.getElementById('security-score');
        
        if (vulnStatusEl) {
            vulnStatusEl.textContent = status;
            vulnStatusEl.className = `vulnerability-indicator ${statusClass}`;
        }
        
        if (scoreEl) {
            scoreEl.textContent = `Puntuaci√≥n: ${analysis.score}/100`;
        }
        
        // Mostrar c√≥digo analizado
        const securityStatus = document.getElementById('security-status');
        if (securityStatus) {
            let displayCode = `// Analizando c√≥digo...\n\n${code}\n\n`;
            displayCode += `// Estado: ${analysis.secure ? '‚úÖ SEGURO' : '‚ùå VULNERABLE'}\n`;
            displayCode += `// Puntuaci√≥n: ${analysis.score}/100`;
            securityStatus.textContent = displayCode;
        }
        
        // Mostrar vulnerabilidades
        const vulnContent = document.getElementById('vulnerabilities-content');
        if (vulnContent) {
            if (analysis.issues.length > 0) {
                vulnContent.innerHTML = analysis.issues.map(issue => `<div class="text-red-400 mb-1">üö® ${issue}</div>`).join('');
            } else {
                vulnContent.innerHTML = '<div class="text-green-400">‚úÖ No se detectaron vulnerabilidades</div>';
            }
        }
        
        // Mostrar recomendaciones
        const recContent = document.getElementById('recommendations-content');
        if (recContent) {
            const recommendations = generateRecommendations(analysis, knownVulns);
            recContent.innerHTML = recommendations.map(rec => `<div class="text-blue-400 mb-1">üí° ${rec}</div>`).join('');
        }
    }

    function updateSecurityStatus(message, type, score = 0) {
        const securityStatus = document.getElementById('security-status');
        if (securityStatus) {
            securityStatus.textContent = message;
        }
        
        const vulnStatus = document.getElementById('vulnerability-status');
        if (vulnStatus) {
            vulnStatus.textContent = type;
            vulnStatus.className = `vulnerability-indicator ${type === 'ESPERANDO' ? 'vuln-safe' : 'vuln-vulnerable'}`;
        }
        
        const scoreEl = document.getElementById('security-score');
        if (scoreEl) {
            scoreEl.textContent = `Puntuaci√≥n: ${score}/100`;
        }
    }

    function generateRecommendations(analysis, vulnerabilities) {
        const recommendations = [];
        
        if (analysis.issues.includes('Falta usar placeholders (? o $1, $2)')) {
            recommendations.push('Usa placeholders (?) en lugar de concatenaci√≥n');
        }
        if (analysis.issues.some(issue => issue.includes('validaci√≥n'))) {
            recommendations.push('Implementa validaci√≥n robusta de entrada');
        }
        if (analysis.issues.some(issue => issue.includes('whitelist'))) {
            recommendations.push('Usa whitelisting para par√°metros din√°micos');
        }
        if (analysis.issues.some(issue => issue.includes('ORM'))) {
            recommendations.push('Evita consultas raw en ORMs');
        }
        
        if (recommendations.length === 0) {
            recommendations.push('¬°Excelente trabajo! El c√≥digo parece seguro');
        }
        
        return recommendations;
    }

    function updateSecurityStatus(message, type) {
        const securityStatus = document.getElementById('security-status');
        securityStatus.textContent = message;
        
        const vulnStatus = document.getElementById('vulnerability-status');
        vulnStatus.textContent = type;
        vulnStatus.className = `vulnerability-indicator ${type === 'ESPERANDO' ? 'vuln-safe' : 'vuln-vulnerable'}`;
    }

    function showResult(element, message, type) {
        element.innerHTML = message;
        element.className = `mt-4 p-3 rounded-md text-sm min-h-[50px] ${
            type === 'success' ? 'bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-200' :
            type === 'error' ? 'bg-red-100 dark:bg-red-900/50 text-red-800 dark:text-red-200' :
            'bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200'
        }`;
    }

    function completeChallenge(id) {
        if (!state.completedLevels.includes(id)) {
            state.completedLevels.push(id);
            
            // Desbloquear siguiente nivel
            if (id < 5 && !state.unlockedLevels.includes(id + 1)) {
                state.unlockedLevels.push(id + 1);
                unlockChallenge(id + 1);
                showToast(`¬°Nivel ${id + 1} desbloqueado!`);
            }
            
            updateProgress();
        }
    }

    function unlockChallenge(id) {
        const challenge = document.getElementById(`challenge-${id}`);
        if (challenge) {
            challenge.classList.remove('locked');
            challenge.classList.add('border-green-500');
        }
    }

    function updateProgress() {
        const totalChallenges = 5;
        const completedCount = state.completedLevels.length;
        const percentage = (completedCount / totalChallenges) * 100;
        
        document.getElementById('progress-bar').style.width = `${percentage}%`;
        document.getElementById('progress-text').textContent = 
            `${percentage.toFixed(0)}% completado - ${completedCount}/${totalChallenges} desaf√≠os completados`;
    }

    function toggleHint(id) {
        const hint = document.getElementById(`hint-${id}`);
        hint.classList.toggle('hidden');
    }

    function showToast(message) {
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toast-message');
        
        toastMessage.textContent = message;
        toast.classList.add('show');
        
        setTimeout(() => {
            toast.classList.remove('show');
        }, 3000);
    }
    </script>

</body>
</html>
